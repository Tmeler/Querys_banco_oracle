  select 
EXT.AGN_IN_CODIGO AS COD_CLIENTE,
EXT.AGN_ST_NOME AS NOME_CLIENTE,
EXT.BLO_ST_NOME AS BLOCO,
EXT.EMP_ST_NOME AS EMPREENDIMENTO,
EXT.ETP_ST_NOME AS ETAPA,
EXT.CSF_ST_DESCRICAO AS TIPO_CONTRATO,
EXT.CTO_DS_STATUS AS STATUS_CONTRATO,
EXT.CTO_DT_ASSINATURA AS DATA_ASSINATURA,
EXT.CTO_DT_CADASTRO AS DATA_CADASTRO,
EXT.CTO_DT_ENTREGA AS DATA_ENTREGA,
EXT.CTO_DT_STATUS AS DATA_STATUS,
EXT.CTO_DT_ULT_VENCIMENTO AS ULTIMO_VCTO,
EXT.CTO_IN_CODIGO AS CONTRATO,
EXT.CTO_RE_VALORCONTRATO AS VALOR_CONTRATO,
EXT.DATA_BASE AS DATA_BASE,
DECODE(UPPER(EXT.PAR_CH_PARCELA),
       'M', 'MENSAL',
       'S', 'SINAL',
       'I', 'INTERMEDIÁRIA',
       'C', 'CONCLUSÃO',
       'C', 'CESSÃO DE DIREITOS',
       'Q', 'QUITADO',
       'OUTRO') AS TIPO_PARCELA,
EXT.PAR_DT_BAIXA AS DATA_PAGAMENTO,
EXT.PAR_DT_VENCIMENTO AS VENCIMENTO_PARCELA,
EXT.PAR_IN_CODIGO AS PARCELA,
EXT.PAR_NR_PARCELASATRASO AS NUMERO_PAR_ATRASADAS,
EXT.PAR_NR_PARCELASVENCER AS PARCELAS_A_VENCER,
EXT.PAR_RE_CORATEVCTO AS CORR_VCTO,
EXT.PAR_RE_CORRECAOATRASO AS CORR_ATRASO,
EXT.PAR_RE_CORRECAOTOTAL AS CORR_TOTAL,
EXT.PAR_RE_CORRECAOVCTO,
EXT.PAR_RE_CREDITO,
EXT.PAR_RE_DIFTAXA,
EXT.PAR_RE_JROTPNCOBRADO,
EXT.PAR_RE_JUROSTOTAL,
EXT.PAR_RE_JUROSVENCTO,
EXT.PAR_RE_MORAATRASO AS MORA,
EXT.PAR_RE_MULTAATRASO AS MULTA,
EXT.PAR_RE_PAGOCORRIGIDO,
EXT.PAR_RE_PARATUALIZADA AS PARCELA_ATUALIZADA,
EXT.PAR_RE_PARCORRIGIDA AS PARCELA_CORRIGIDA,
EXT.PAR_RE_PARCORRIGIDA_MV,
EXT.PAR_RE_PERCVMJUROS,
EXT.PAR_RE_RECEB_ATUALIZADO,
EXT.PAR_RE_RESIDUOCOBRANCA,
EXT.PAR_RE_SALDOQUITACAO,
EXT.PAR_RE_TAXAMORA,
EXT.PAR_RE_TAXAMULTA,
EXT.PAR_RE_TAXASADIC,
EXT.PAR_RE_TOTALAPAGAR AS TOTAL_PARCELA,
EXT.PAR_RE_TX_VLR_PRESENTE,
EXT.PAR_RE_VALOR_ATRASO,
EXT.PAR_RE_VALOR_ATRASOCORR,
EXT.PAR_RE_VALOR_ATRASOCORRR,
EXT.PAR_RE_VALOR_ATRASOENC,
EXT.PAR_RE_VALOR_ATRASOENCR,
EXT.PAR_RE_VALOR_ATRASOR,
EXT.PAR_RE_VALOR_FINANC,
EXT.PAR_RE_VALOR_FUTURO,
EXT.PAR_RE_VALOR_PRESENTE,
EXT.PAR_RE_VALORATRASO,
EXT.PAR_RE_VALORCORRECAO,
EXT.PAR_RE_VALORCORRECAO_ATR,
EXT.PAR_RE_VALORCORRECAOBX,
EXT.PAR_RE_VALORDESCONTO,
EXT.PAR_RE_VALORJUROS,
EXT.PAR_RE_VALORJUROSBX,
EXT.PAR_RE_VALORJUROSREN,
EXT.PAR_RE_VALORJUROSTP,
EXT.PAR_RE_VALORMULTA,
EXT.PAR_RE_VALORORIGINAL,
EXT.PAR_RE_VALORPAGO,
EXT.PAR_RE_VALORRESCOB_AGERAR,
EXT.PAR_RE_VALORRESIDUO,
EXT.PAR_RE_VALORRESIDUO_CC,
EXT.PAR_RE_VALORVENCER,
EXT.PAR_RE_VLR_PRESENTE,
EXT.PAR_RE_VLR_SIMULATP,
EXT.PAR_RE_VLRPAGO AS VALOR_PAGO,
EXT.PAR_RE_VLRQUITACAO,
EXT.PAR_ST_HISTORICO AS PROCESSO,
EXT.PAR_ST_OBSERVACAO,
EXT.PAR_ST_OBSGERACAO AS GERACAO,
EXT.PAR_ST_OBSPROCESSO AS OBS,
EXT.PAR_ST_REAJUSINDICE,
EXT.PAR_ST_RESIDUO,
EXT.PAR_ST_RESIDUOCOBRANCA,
EXT.PRO_IN_REDUZIDO AS COD_PROJETO,
EXT.PRO_ST_DESCRICAO AS PROJETO,
EXT.RESCOB_IN_CODIGO,
EXT.TPU_ST_DESCRICAO AS TIPOLOGA,
EXT.UND_RE_AREAPRIVATIVA AS AREA_PRIV,
EXT.UND_ST_NOME AS UNIDADE,
EXT.CTO_RE_JUROS AS JUROS_CONT,
EXT.CTO_RE_MORA AS MORA_CONT,
EXT.CTO_RE_VALORCONTRATO_ATU,
EXT.CALCULAATRASO,
EXT.CTO_NR_MESES_ADIMPLENTE,
EXT.CTO_NR_MESES_ASSINATURA,
EXT.CTO_NR_MESES_AVENCER,
EXT.CALCULAMORA

FROM CONSTRUCAO.CAR_DW_PARCELA@HACASA EXT

WHERE EXT.PAR_DT_VENCIMENTO BETWEEN ADD_MONTHS(TO_DATE(CURRENT_DATE), -120) AND ADD_MONTHS(TO_DATE(CURRENT_DATE), 360) AND
      EXT.DW_BO_RECEB is null